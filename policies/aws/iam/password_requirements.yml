policies:
  - name: aws-iam-password-requirements
    description: |
      Check if the password policies adhere to CIS guidelines. Make them CIS compliant if they are don't.
    resource: aws.account
    filters:
      - or:
        - type: password-policy
          key: PasswordReusePrevention
          value: 10
          op: lt
        - type: password-policy
          key: MinimumPasswordLength
          value: 10
          op: lt          
        - type: password-policy
          key: MaxPasswordAge
          value: 90
          op: lt          
        - type: password-policy
          key: RequireSymbols
          value: false
        - type: password-policy
          key: RequireNumbers
          value: false
        - type: password-policy
          key: RequireLowercaseCharacters
          value: false
        - type: password-policy
          key: RequireUppercaseCharacters
          value: false          
        - type: password-policy
          key: PasswordPolicyConfigured
          value: false
    actions:
      - type: set-password-policy
        policy: 
          PasswordReusePrevention: 10
      - type: set-password-policy
        policy: 
          MinimumPasswordLength: 10          
      - type: set-password-policy
        policy: 
          MaxPasswordAge: 90
      - type: set-password-policy
        policy: 
          RequireSymbols: true          
      - type: set-password-policy
        policy: 
          RequireNumbers: true   
      - type: set-password-policy
        policy: 
          RequireLowercaseCharacters: true   
      - type: set-password-policy
        policy: 
          RequireUppercaseCharacters: true